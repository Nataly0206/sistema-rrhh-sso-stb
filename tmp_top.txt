<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>Identificación de Riesgo por Puesto</title>
<style>
  :root{
    --border:#000;
    --gris:#bfbfbf;
    --font: "Arial", Helvetica, sans-serif;
  }
  *{ box-sizing:border-box; }
  body{ margin:0; font-family:var(--font); color:#000; }
  .a4{ width:210mm; margin:0 auto; padding:10mm 12mm; }

  /* Encabezado */
  .head{ display:flex; align-items:flex-start; gap:12px; }
  .head img{ height:48px; width:auto; object-fit:contain; margin-top:2px; }
  .head-text{ text-align:center; flex:1; line-height:1.2; font-size:12px; text-transform:uppercase; }
  .head-text .line1{ font-weight:700; }
  .head-hr{ border:none; border-top:1px solid var(--border); margin:6px 0 0; }

  /* Barras de sección */
  .bar{ background:var(--gris); color:#000; text-transform:uppercase; 
        font-weight:700; text-align:center; padding:6px; border:1px solid var(--border); }

  /* Tabla principal */
  table.sheet{ width:100%; border-collapse:collapse; table-layout:fixed; }
  .sheet td, .sheet th{ border:1px solid var(--border); vertical-align:top; }
  .label{ width:36%; padding:6px; font-size:12px; }
  .field{ width:64%; padding:0; }

  /* Campos (estilo “celda vacía”) */
  .cell-input, .cell-textarea{
    width:100%; border:0; padding:8px; font:inherit; resize:none; 
    outline:none; background:transparent;
  }
  .cell-textarea{ height:90px; } /* alto para “Descripción General de la labor” */
  .objetivo{ height:110px; }

  /* Imprime bonito */
  @media print{
    body{ margin:0; }
    .a4{ width:auto; padding:0; }
  }
  /* --- Ajustes globales (sin cambiar contenido) --- */
  /*.sheet col{ width:auto !important; }                 /* anula colgroups desparejos */
  .sheet{ table-layout:fixed; }                        /* grilla estable para imprimir */
  .sheet th, .sheet td{ padding:6px 8px; line-height:1.25; }
  .sheet th{ font-size:11px; }
  .sheet th, .sheet td{ white-space:normal; overflow-wrap:anywhere; word-break:normal; hyphens:auto; }
  .cell-input, .cell-textarea{ padding:6px 8px; }

  /* 7) Firmas/fechas: evita cortes raros en las etiquetas */
  .sheet .label-cell{ white-space:normal; }

  /* Poner TODAS las celdas TIPO en vertical */
.risk-table td.tipo{
  writing-mode: vertical-rl;   /* texto de arriba hacia abajo */
  text-orientation: mixed;     /* mantiene letras latinas derechas */
  white-space: nowrap;         /* evita cortes o saltos raros */
  text-align: center;          /* centra horizontalmente */
  vertical-align: middle;      /* centra verticalmente (sobre el rowspan) */
  padding: 8px 4px;
}

/* Oculta los <br> dentro de la celda tipo para que sea una sola línea vertical */
.risk-table td.tipo br{ display:none; }

/* (Opcional) si quieres estrechar la primera columna:
.risk-table td.tipo{ width:32px !important; }
*/

  /* Vertical abajo → arriba (letras derechas) */
  .risk-table td.tipo{
    writing-mode: vertical-rl;   /* columna vertical */
    text-orientation: mixed;     /* letras latinas derechas */
    transform: rotate(180deg);   /* invierte el sentido a abajo→arriba */
    white-space: nowrap;
    text-align: center;
    vertical-align: middle;
    padding: 8px 4px;
  }
  /* Re-endereza el texto dentro para que no quede cabeza abajo */
  .risk-table td.tipo .tipo-inner{
    display: inline-block;
    transform: rotate(180deg);
  }
  /* Opcional: ocultar <br> dentro de TIPO para que sea una sola línea vertical */
  .risk-table td.tipo br{ display:none; }

  /* Opcional: ajustar ancho de la columna TIPO si quieres más angosta */
  /* .risk-table td.tipo{ width:32px !important; } */

  .actions{ margin-top:12px; }
.btn-guardar{
  display:block;
  width:100%;
  padding:12px 16px;
  font:700 16px var(--font);
  text-transform:uppercase;
  border:1px solid var(--border);
  border-radius:8px;
  background: linear-gradient(180deg, #2ea043, #1f7a35); /* verde agradable */
  color:;
  box-shadow: 0 2px 6px rgba(0,0,0,.15);
  cursor:pointer;
}
.btn-guardar:hover{ filter:brightness(1.05); }
.btn-guardar:active{ transform:translateY(1px); box-shadow: 0 1px 4px rgba(0,0,0,.2); }
.btn-guardar:disabled{
  background:#9ccaa8; color:#fff; cursor:not-allowed; box-shadow:none;
}
/* No mostrar al imprimir */
@media print{ .actions{ display:none; } }
</style>

<script>
  // Envuelve el contenido actual de cada TIPO en un span (una sola vez)
  document.querySelectorAll('.risk-table td.tipo').forEach(td => {
    if (!td.querySelector('.tipo-inner')) {
      td.innerHTML = '<span class="tipo-inner">' + td.innerHTML + '</span>';
    }
  });
</script>

</head>
<body>
  <div class="a4">
    <!-- ENCABEZADO -->
    <div class="head">
      <img src="{{ asset('img/logo.PNG') }}" alt="Logo">
      <div class="head-text">
        <div class="line1">Service and Trading Business S.A. de C.V.</div>
        <div>Proceso Salud y Seguridad Ocupacional / Health and Occupational Safety Process</div>
        <div>Identificación de riesgo por puesto de trabajo / Identification of risk by work position</div>
      </div>
    </div>
    <hr class="head-hr">

    <!-- DATOS GENERALES DEL PUESTO -->
    <div class="bar">Datos Generales del Puesto</div>
    <table class="sheet">
      <colgroup>
        <col style="width:36%">
        <col style="width:64%">
      </colgroup>
      <tr>
        <td class="label">Puesto de Trabajo Analizado</td>
        <td class="field">
            <input type="text" id="puesto-input" list="puestos-list" class="cell-input" placeholder="Escribe para buscar…" autocomplete="off">
            <datalist id="puestos-list">
                @foreach ($puestos as $p)
                    <option data-id="{{ $p->id_puesto_trabajo_matriz }}" value="{{ $p->puesto_trabajo_matriz }}"></option>
                @endforeach
            </datalist>
        </td>
      </tr>
      <tr>
        <td class="label">Departamento</td>
        <td class="field"><input class="cell-input" type="text" name="departamento"></td>
      </tr>
      <tr>
        <td class="label">N° de empleados por puesto de trabajo</td>
        <td class="field"><input class="cell-input" type="number" min="0" name="num_empleados"></td>
      </tr>
    </table>

    <!-- === estilos mínimos extra (si aún no los tienes) === -->
    <style>
      .sheet thead th{ background:#bfbfbf; text-align:center; font-weight:700; padding:6px; }
      .sheet .label-cell{ padding:8px; font-size:12px; }
      .cell-input{ width:100%; border:0; padding:8px; font:inherit; background:transparent; outline:none; }
    </style>

    <!-- ===================== ESFUERZO FISICO ===================== -->
    <div class="bar" style="margin-top:8px;">ESFUERZO FISICO</div>
    <table class="sheet">
  <colgroup>
    <col style="width:12%">
    <col style="width:20%">
    <col style="width:14%">
    <col style="width:16%">
    <col style="width:14%">
    <col style="width:12%">
    <col style="width:12%">
  </colgroup>
  <thead>
    <tr>
      <th>Tipos de esfuerzo</th>
      <th>Descripción de Carga</th>
      <th>Equipo de apoyo</th>
      <th>Duración de carga</th>
      <th>Distancia de carga</th>
      <th>Frecuencia</th>
      <th>Peso aproximado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
